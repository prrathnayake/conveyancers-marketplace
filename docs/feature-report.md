# Feature Gap Assessment

This document benchmarks the current codebase against the requested feature catalogue. Status values are:

- **Available** – implemented in code or configuration.
- **Partial** – scaffolded or simulated, but missing critical integrations or automation.
- **Missing** – no supporting implementation beyond documentation intent.

## Detailed Matrix

| Category | Feature / Module | Status | Evidence & Gap Summary |
| --- | --- | --- | --- |
| User Onboarding & Identity | Multi-Role Registration | Available | `/auth/register` provisions buyer, seller, conveyancer, and admin accounts, creating linked profiles and returning TOTP setup metadata for onboarding flows.【F:backend/services/identity/main.cpp†L149-L197】【F:backend/services/identity/main.cpp†L1180-L1221】 |
| User Onboarding & Identity | Know-Your-Customer (KYC) | Partial | Admin-only `/profiles/{id}/kyc` updates persist references and approval state, yet decisions rely on manual payloads with no third-party provider hooks or webhook ingestion.【F:backend/services/identity/main.cpp†L305-L319】【F:backend/services/identity/main.cpp†L1062-L1084】 |
| User Onboarding & Identity | Two-Factor Authentication (2FA) | Available | Login issues short-lived challenges and validates user-entered TOTP codes before minting session tokens, enforcing per-account secrets stored during registration.【F:backend/services/identity/main.cpp†L380-L428】【F:backend/services/identity/main.cpp†L1223-L1258】 |
| Conveyancer Profile Management | Profile Creation | Available | Registration bootstraps conveyancer profiles with biography, services, and specialties while persisting account-profile mappings for later updates.【F:backend/services/identity/main.cpp†L149-L197】 |
| Conveyancer Profile Management | Licence & Insurance Verification | Available | Licence numbers and PI insurance details are cross-checked against an embedded registry before ConveySafe badges are issued, with failed matches revoking verification timestamps and raising alerts.【F:backend/services/identity/main.cpp†L120-L210】【F:backend/services/identity/main.cpp†L660-L724】 |
| Conveyancer Profile Management | Geographic Restrictions | Partial | Hard-coded guardrails prevent unverified QLD/ACT practitioners from appearing, yet full jurisdiction gating and admin overrides are absent.【F:backend/services/identity/main.cpp†L42-L109】 |
| Search & Discovery | Directory & Filters | Available | `/profiles/search` supports keyword, state, and verified filters with JSON responses designed for directory listings.【F:backend/services/identity/main.cpp†L83-L113】 |
| Search & Discovery | Profile View | Partial | `/profiles/{id}` now delivers compliance badges and aggregated reviews, but still lacks rich job histories or document badges described in requirements.【F:backend/services/identity/main.cpp†L431-L489】【F:backend/services/identity/main.cpp†L1040-L1055】 |
| Search & Discovery | SEO & CMS | Partial | The README confirms SSR-ready Next.js and an admin console scaffold, yet there is no CMS editing or SEO metadata governance described in code.【F:README.md†L30-L35】 |
| Communication & Document Exchange | Secure Messaging | Available | Marketplace clients exchange encrypted chat threads with policy-aware warnings that flag emails/phone numbers, log ConveySafe alerts, and keep evidence inside the platform.【F:frontend/pages/api/chat/messages.ts†L1-L134】【F:frontend/pages/chat.tsx†L1-L226】 |
| Communication & Document Exchange | Contact Gating | Available | Job contact endpoints keep buyer/seller details masked until a finance admin submits the scoped unlock token produced during payment hold creation, ensuring contact is only revealed after funds are initiated.【F:backend/services/payments/main.cpp†L767-L796】【F:backend/services/jobs/main.cpp†L950-L1518】 |
| Communication & Document Exchange | Voice & Video Sessions | Available | Parties can spin up voice or video sessions directly on a job, with generated join URLs, scoped access tokens, and admin-visible logs of every call session for oversight.【F:backend/services/jobs/main.cpp†L600-L1576】 |
| Communication & Document Exchange | File Upload & Scanning | Partial | Participants can upload documents through the secure chat flow with at-rest encryption, yet no antivirus scanning or external storage tier is wired in.【F:frontend/pages/api/chat/upload.ts†L1-L95】 |
| Communication & Document Exchange | Electronic Signatures | Partial | Document APIs track `requires_signature`, expose signing endpoints, and record signed status, yet there is no external e-sign provider, certificate storage, or tamper-proof audit log.【F:backend/services/jobs/main.cpp†L477-L505】【F:backend/services/jobs/main.cpp†L1370-L1396】 |
| Job Management | Job Creation | Available | `/jobs` now accepts POST payloads that persist conveyancer-led engagements, seed milestones, and immediately apply contact masking policies for each new matter.【F:backend/services/jobs/main.cpp†L349-L395】【F:backend/services/jobs/main.cpp†L1127-L1145】 |
| Job Management | Milestones & Quotes | Partial | Milestone structures with escrow indicators are available, yet quote authoring, deadline workflows, and notifications are not automated.【F:backend/services/jobs/main.cpp†L52-L281】 |
| Payments & Escrow | Escrow Setup | Available | Escrow holds now capture the responsible conveyancer, surface loyalty fee rates, and feed ConveySafe SecurePay and loyalty tier endpoints for economic lock-in.【F:backend/services/payments/main.cpp†L67-L115】【F:backend/services/payments/main.cpp†L640-L813】 |
| Payments & Escrow | Trust Account Payouts | Partial | Release endpoints transition holds to a released state, but there is no linkage to conveyancer trust accounts or compliance reporting.【F:backend/services/payments/main.cpp†L233-L259】 |
| Payments & Escrow | Invoicing & Fees | Available | Checkout flows mint GST-rounded invoices with itemised service fees, dedicated APIs allow manual issuance, and metrics surface outstanding balances for finance teams.【F:backend/services/payments/main.cpp†L335-L476】【F:backend/services/payments/main.cpp†L912-L1214】 |
| Work Execution | Task Tracking | Available | A reusable template library seeds jurisdiction-specific task bundles that can be applied to any job, generating due-dated milestones with escrow requirements and assignment metadata.【F:backend/services/jobs/main.cpp†L248-L268】【F:backend/services/jobs/main.cpp†L629-L1688】 |
| Work Execution | Document Management | Available | Document entities now track encrypted version history, role-scoped access, and admin/audit endpoints for uploads, signatures, and new revisions.【F:backend/services/jobs/main.cpp†L203-L360】【F:backend/services/jobs/main.cpp†L1448-L1626】 |
| Completion & Feedback | Job Completion | Available | Conveyancers can close jobs through `/jobs/{id}/complete`, triggering compliance summaries, certificate generation, and last-activity timestamps for audit trails.【F:backend/services/jobs/main.cpp†L558-L604】【F:backend/services/jobs/main.cpp†L1363-L1382】 |
| Completion & Feedback | Verified Completion Certificates | Available | Completion triggers issue a system-signed certificate with download URL and verification code, retrievable via a dedicated endpoint and surfaced in the admin safety dashboard.【F:backend/services/jobs/main.cpp†L939-L1595】【F:admin-portal/pages/safety.tsx†L1-L264】 |
| Completion & Feedback | Reviews & Ratings | Available | Buyers and sellers can create 1–5 star reviews that update aggregate scores and surface alongside profile payloads for discovery surfaces.【F:backend/services/identity/main.cpp†L261-L303】【F:backend/services/identity/main.cpp†L1148-L1177】 |
| Dispute & Support | Dispute Workflow | Available | Disputes can now be opened, listed, and resolved with evidence attachments, with admin-only status transitions for adjudication.【F:backend/services/jobs/main.cpp†L469-L1463】 |
| Dispute & Support | Customer Support | Available | Admin support endpoints issue time-boxed impersonation tokens, reset 2FA secrets, and approve or reject KYC with full audit logging for each action.【F:backend/services/identity/main.cpp†L698-L779】【F:backend/services/identity/main.cpp†L1580-L1665】 |
| Admin Panel | User Management | Partial | The README references an admin console scaffold, but backend APIs for verifying/deactivating users are not implemented.【F:README.md†L30-L35】【F:backend/services/identity/main.cpp†L83-L113】 |
| Admin Panel | Safety Dashboard | Available | A dedicated safety surface summarises contact gating, certificate issuance, voice/video calls, and ML risk signals pulled from the jobs service for admin-only oversight.【F:admin-portal/components/AdminLayout.tsx†L6-L32】【F:admin-portal/pages/safety.tsx†L1-L264】 |
| Admin Panel | Enquiry Audit Search | Available | Admin operators can search chat transcripts, review participants, and download attachments directly from the control panel when handling escalations.【F:admin-portal/pages/enquiries.tsx†L1-L162】【F:admin-portal/pages/api/enquiries.ts†L1-L161】 |
| Admin Panel | Compliance Monitoring | Available | Identity service now surfaces `/admin/compliance/alerts` with jurisdiction, insurance, and verification warnings for admins.【F:backend/services/identity/main.cpp†L642-L689】【F:backend/services/identity/main.cpp†L324-L366】 |
| Admin Panel | Audit Logging | Partial | Services log request metadata via shared helpers, but immutable append-only audit storage is not in place.【F:backend/common/security.h†L26-L45】 |
| Infrastructure & Architecture | Frontend | Partial | The README outlines a Next.js + Tailwind stack fronted by Nginx, yet feature depth (filters, chat UI, CMS) is not verifiable in code excerpts.【F:README.md†L30-L47】 |
| Infrastructure & Architecture | Backend Microservices | Available | Gateway plus identity, jobs, and payments services are documented and implemented with REST endpoints.【F:README.md†L36-L41】【F:backend/services/jobs/main.cpp†L235-L334】【F:backend/services/payments/main.cpp†L179-L293】 |
| Infrastructure & Architecture | Databases | Partial | Compose targets for Postgres/Redis/MinIO are described, but runtime code still uses in-memory stores pending real adapters.【F:README.md†L43-L47】【F:backend/services/jobs/main.cpp†L52-L117】【F:backend/services/payments/main.cpp†L59-L125】 |
| Infrastructure & Architecture | Observability | Partial | Observability stack is documented, yet service code lacks explicit OpenTelemetry exporters or metrics emission.【F:README.md†L43-L47】【F:README.md†L197-L199】 |
| Infrastructure & Architecture | Deployment | Available | Docker Compose workflow with TLS scripts and env templates is fully documented for local deployment.【F:README.md†L91-L166】 |
| Security & Compliance | Authentication | Partial | API key plus role headers enforce basic RBAC, but JWT issuance and refresh token lifecycles are absent.【F:backend/common/security.h†L16-L45】 |
| Security & Compliance | Data Security | Partial | Sensitive runtime secrets have been externalised into environment configuration and the frontend now fails fast when `JWT_SECRET` is unset, but transport encryption and at-rest controls remain unimplemented.【F:.env.example†L1-L49】【F:frontend/lib/session.ts†L20-L29】 |
| Security & Compliance | Privacy | Available | APIs capture privacy acknowledgements, marketing preferences, erasure requests, and admin review workflows with audit events for every transition.【F:backend/services/identity/main.cpp†L600-L735】【F:backend/services/identity/main.cpp†L1433-L1553】 |
| Security & Compliance | Licensing & Trust Compliance | Partial | Documentation highlights state restrictions and escrow best practices, but automated validation and trust account reconciliation are not implemented.【F:docs/compliance.md†L1-L5】【F:backend/services/payments/main.cpp†L233-L287】 |
| Security & Compliance | Record Retention | Available | Administrators can invoke `/admin/audit/purge` to enforce audit log retention windows programmatically.【F:backend/services/identity/main.cpp†L690-L708】【F:backend/services/identity/main.cpp†L344-L366】 |
| Security & Compliance | Off-Platform Leakage Monitoring | Available | The jobs service aggregates ML heuristics across message metadata, payment activity, retention, and IP pairings to flag probable off-platform handoffs via `/admin/ml/insights`.【F:backend/services/jobs/main.cpp†L671-L1712】 |
| Performance & Monitoring | Metrics & Alerts | Available | Shared security helpers track request counters and auth failures, exposing Prometheus-formatted metrics behind `/metrics` on every service.【F:backend/common/security.h†L118-L213】【F:backend/services/jobs/main.cpp†L471-L476】【F:backend/gateway/src/main.cpp†L48-L52】 |
| Performance & Monitoring | Logging & Tracing | Partial | Basic request logging is enabled, though distributed tracing identifiers or secure log retention are not wired up.【F:backend/common/security.h†L26-L45】 |

## Key Recommendations

1. Automate compliance signals—wire external KYC, licence registries, and signature providers into the existing admin endpoints so approvals and certificate issuance are auditable.
2. Replace in-memory fixtures with persistent adapters for profiles, jobs, documents, and payments so that observability and retention controls become meaningful.
3. Layer PSP settlement, invoicing, and anti-virus/document retention services to meet the regulated experience outlined in the requirements.
